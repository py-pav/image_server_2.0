# Image Hosting Service 2.0

## Оглавление
1. [Краткое описание проекта](#краткое-описание-проекта)  
2. [Инструкция по развертыванию проекта](#инструкция-по-развертыванию-проекта)  
3. [Управление сервисом](#управление-сервисом)  
4. [Ключевые маршруты API](#ключевые-маршруты-api)  
5. [Резервное копирование](#резервное-копирование)  
6. [Требования к окружению](#требования-к-окружению)  
7. [Контактная информация](#контактная-информация)  

---

### Краткое описание проекта
Сервис для хранения и просмотра изображений в виде веб-приложения. Пользователи могут загружать изображения в форматах **JPG, PNG, GIF** (максимальный размер — **5 МБ**) и получать прямые ссылки на них. 
Файлы изображений хранятся в папке images. Хранение информации о файлах (имя, размер, дата загрузки, тип) реализовано с помощью БД Postgres (таблица images)

1. Основные возможности:  
- Загрузка и удаление изображений через веб-интерфейс.
- Генерация прямых ссылок на изображения.  
- Пагинация по списку изображений
- Быстрая раздача файлов через **Nginx**.  
- Контейнеризация через Docker

2. Структура проекта
   ```bash
   image_server/
   ├── app.py                # Основной Python-бэкенд
   ├── db_manager.py         # Класс для работы с базой данных (postgres)
   ├── make_images_table.py  # Методы для обработки страницы image-list
   ├── requirements.txt      # Зависимости Python
   ├── Dockerfile            # Dockerfile для Python-бэкенда
   ├── docker-compose.yml    # Конфигурация Docker Compose
   ├── nginx.conf            # Конфигурация Nginx
   ├── images/               # Папка для хранения загруженных изображений
   ├── logs/                 # Папка для логов
   ├── backup/               # Папка для хранения резервных копий
   └── static/               # Дополнительные статические файлы (HTML/CSS/JS)

---

### Инструкция по развертыванию проекта
1. Убедитесь, что на сервере установлены **Docker** и **Docker Compose**.  
2. Склонируйте репозиторий:  
   ```bash
   git clone https://github.com/py-pav/image_server_2.0.git
   cd image_server
3. Настройте конфигурацию (при необходимости отредактируйте nginx.conf и docker-compose.yml).
4. Запустите проект с помощью Docker Compose.
   ```bash
   docker compose up --build -d
5. Сервис будет доступен по адресу [http://localhost:8000/](http://localhost:8000/)
   
---

### Управление сервисом
| Команда                  | Действие                                   |
|--------------------------|-------------------------------------------|
| `docker-compose stop`    | Остановить сервис                         |
| `docker-compose restart` | Перезапустить сервис                      |
| `docker-compose down`    | Полная остановка с удалением контейнеров  |
   

---

### Ключевые маршруты API
| Метод    | Маршрут                 | Описание                                     |
|----------|-------------------------|----------------------------------------------|
| `GET`    | `/`                     | Веб-интерфейс загрузки изображений           |
| `POST`   | `/upload`               | Загрузка изображения 						                  |
| `GET`    | `/images-list/<name>`   | Получение изображения по имени (через Nginx) |
| `GET`    | `/images-list?page=`    | Пагинация по списку изображений              |
| `DELETE` | `/delete_image/<name>`  | Удаление изображения по имени                |

---

### Резервное копирование
| Команда                                                                                             | Действие                               |
|-----------------------------------------------------------------------------------------------------|----------------------------------------|
| `docker exec -t postgres_17_5 pg_dump -U postgres images_db > ./backup/dump_$(date +%F_%H%M%S).sql` | Создание dump'a для Linux/MacOS (Bash) |
| `docker exec -t postgres_17_5 pg_dump -U postgres images_db > "./backup/dump_$(Get-Date -Format 'yyyy-MM-dd_HHmmss').sql"` | Создание dump'a для Windows            |
| `docker exec -i postgres_17_5 psql -U postgres -d images_db < dump.sql`                             | Восстановление                         |
---

### Требования к окружению

- Docker (версия 20.10+)
- Docker Compose (версия 2.0+)
- Linux/Windows/macOS с поддержкой Docker

Рекомендуемые ресурсы сервера:
- 1 ГБ RAM
- 10 ГБ свободного места (для хранения изображений)

---

### Контактная информация
 - [Telegram](https://t.me/py_pav): @py_pav
 - Email: sintez-kr85@mail.ru
